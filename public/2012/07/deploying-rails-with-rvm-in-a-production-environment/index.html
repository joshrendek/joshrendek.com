<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8" />
<meta name="author" content="" />
<meta name="description" content="" />
<meta name="keywords" content="" />
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.25.1" />

<meta property="og:title" content="Deploying Rails with RVM in a production environment" />
<meta property="og:description" content="Let&rsquo;s start out by logging into our machine and installing some pre-requistes (these can also be found by running rvm requirements as well):
1 sudo apt-get -y install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion git-core mysql-client libmysqlclient-dev libsasl2-dev libsasl2-dev mysql-server  Lets also install nodejs: 1 curl -O http://nodejs.org/dist/v0.8.4/node-v0.8.4.tar.gz 2 tar xzvf node-v0.8.4.tar.gz 3 cd node-v0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://joshrendek.com/2012/07/deploying-rails-with-rvm-in-a-production-environment/" />



<meta property="article:published_time" content="2012-07-26T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2012-07-26T00:00:00&#43;00:00"/>













  <meta name="twitter:card" content="summary"/>



<meta name="twitter:text:title" content="Deploying Rails with RVM in a production environment"/>
<meta name="twitter:title" content="Deploying Rails with RVM in a production environment"/>
<meta name="twitter:description" content="Let&rsquo;s start out by logging into our machine and installing some pre-requistes (these can also be found by running rvm requirements as well):
1 sudo apt-get -y install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion git-core mysql-client libmysqlclient-dev libsasl2-dev libsasl2-dev mysql-server  Lets also install nodejs: 1 curl -O http://nodejs.org/dist/v0.8.4/node-v0.8.4.tar.gz 2 tar xzvf node-v0.8.4.tar.gz 3 cd node-v0."/>




<meta itemprop="name" content="Deploying Rails with RVM in a production environment">
<meta itemprop="description" content="Let&rsquo;s start out by logging into our machine and installing some pre-requistes (these can also be found by running rvm requirements as well):
1 sudo apt-get -y install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion git-core mysql-client libmysqlclient-dev libsasl2-dev libsasl2-dev mysql-server  Lets also install nodejs: 1 curl -O http://nodejs.org/dist/v0.8.4/node-v0.8.4.tar.gz 2 tar xzvf node-v0.8.4.tar.gz 3 cd node-v0.">


<meta itemprop="dateModified" content="2012-07-26T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1538">



<meta itemprop="keywords" content="" />


<link rel="stylesheet" type="text/css" href="/css/layout.css" />
<link rel="stylesheet" type="text/css" href="/css/pygments.css" />
<link rel="stylesheet" type="text/css" href="/css/color-dark.css" />


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-3754808-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


<title>


     Deploying Rails with RVM in a production environment 

</title>

<script src="/js/highlight.min.js"></script>
<link rel="stylesheet" href="/css/tomorrow-night.min.css" />
<script>hljs.initHighlightingOnLoad();</script>

</head>


<body>
<div class="main">
<header>

<div class="header-bar">

  <nav>
    <div class="siteTitle">
      <a href="https://joshrendek.com">
        <span class='blue-brace'>{</span>
        Josh Rendek
        <span class='blue-brace'>}</span>
      </a>
      <div class="header-subtitle">
        <h2>
          <span class="heart">&lt;3</span> Ruby &amp; Go
        </h2>
      </div>
    </div> 
  </nav>
  <nav>
      
      
      <a class="nav-item" href="/"><div class="nav-item-title">Home</div></a>
      
      <a class="nav-item" href="/projects/"><div class="nav-item-title">Projects</div></a>
      
      <a class="nav-item" href="/archives/"><div class="nav-item-title">Archives</div></a>
      
      <a class="nav-item" href="https://devopsbyvideo.com/"><div class="nav-item-title">Screen Casts</div></a>
      
      <a class="nav-item" href="/about/"><div class="nav-item-title">About</div></a>
      
      <a class="nav-item" href="/categories/"><div class="nav-item-title">Categories</div></a>
      
      <a class="nav-item" href="https://github.com/joshrendek/"><div class="nav-item-title">GitHub</div></a>
      
      <a class="nav-item" href="/resume.pdf"><div class="nav-item-title">Resume</div></a>
      
   </nav>
</div>

  
<div class="social-links-header">

  

  

  

  

  

</div>


</header>


<main>
  <div class="articles">
    <article class="post">
      <div class="date"> Jul 26, 2012 - 8 minutes</div>
      <h1 class="title"> Deploying Rails with RVM in a production environment </h1>
      <div class="content"> <p>Let&rsquo;s start out by logging into our machine and installing some pre-requistes (these can also be found by running rvm requirements as well):</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span>sudo apt-get -y install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion git-core mysql-client libmysqlclient-dev libsasl2-dev libsasl2-dev mysql-server
</code></pre></div>


<p>Lets also install nodejs:
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span>curl -O http://nodejs.org/dist/v0.8.4/node-v0.8.4.tar.gz
<span class="lineno">2 </span>tar xzvf node-v0.8.4.tar.gz
<span class="lineno">3 </span><span class="nb">cd </span>node-v0.8.4.tar.gz
<span class="lineno">4 </span>./configure <span class="o">&amp;&amp;</span> make <span class="o">&amp;&amp;</span> sudo make install
</code></pre></div>
</p>

<p>Now we can install ruby and RVM:
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span>curl -L https://get.rvm.io <span class="p">|</span> bash -s stable --ruby
<span class="lineno">2 </span><span class="nb">source</span> /home/ubuntu/.rvm/scripts/rvm
<span class="lineno">3 </span>rvm use 1.9.3 --default
<span class="lineno">4 </span><span class="nb">echo</span> <span class="s1">&#39;rvm_trust_rvmrcs_flag=1&#39;</span> &gt; ~/.rvmrc
<span class="lineno">5 </span><span class="c"># sudo su before this</span>
<span class="lineno">6 </span><span class="nb">echo</span> <span class="s1">&#39;RAILS_ENV=production&#39;</span> &gt;&gt; /etc/environment
<span class="lineno">7 </span>rvm gemset create tester
</code></pre></div>
</p>

<p>And lastly nginx:
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span>sudo apt-get install nginx
</code></pre></div>
</p>

<p>Now let&rsquo;s make a simple rails application back on our development machine with 1 simple root action:
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno"> 1 </span>rails new tester -d<span class="o">=</span>mysql
<span class="lineno"> 2 </span><span class="nb">echo</span> <span class="s1">&#39;rvm use 1.9.3@tester --create&#39;</span> &gt; tester/.rvmrc
<span class="lineno"> 3 </span><span class="nb">cd </span>tester
<span class="lineno"> 4 </span>bundle install
<span class="lineno"> 5 </span>rails g controller homepage index
<span class="lineno"> 6 </span>rm -rf public/index.html
<span class="lineno"> 7 </span><span class="c"># Open up config/routes.rb and modify the root to to point to homepage#index</span>
<span class="lineno"> 8 </span>rake db:create
<span class="lineno"> 9 </span>git init .
<span class="lineno">10 </span>git remote add origin https://github.com/bluescripts/tester.git <span class="c"># replace this with your git repo</span>
<span class="lineno">11 </span>git add .<span class="p">;</span> git ci -a -m <span class="s1">&#39;first&#39;</span><span class="p">;</span> git push -u origin master
<span class="lineno">12 </span>rails s
</code></pre></div>
</p>

<p>Open your browser and go to <a href="http://localhost:3000">http://localhost:3000</a> &ndash; all good! Now lets make some modifications to our Gemfile:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno"> 1 </span><span class="n">source</span> <span class="s1">&#39;https://rubygems.org&#39;</span>
<span class="lineno"> 2 </span><span class="n">gem</span> <span class="s1">&#39;rails&#39;</span><span class="p">,</span> <span class="s1">&#39;3.2.6&#39;</span>
<span class="lineno"> 3 </span><span class="n">gem</span> <span class="s1">&#39;mysql2&#39;</span>
<span class="lineno"> 4 </span><span class="n">group</span> <span class="ss">:assets</span> <span class="k">do</span>
<span class="lineno"> 5 </span>  <span class="n">gem</span> <span class="s1">&#39;sass-rails&#39;</span><span class="p">,</span>   <span class="s1">&#39;~&gt; 3.2.3&#39;</span>
<span class="lineno"> 6 </span>  <span class="n">gem</span> <span class="s1">&#39;coffee-rails&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 3.2.1&#39;</span>
<span class="lineno"> 7 </span>  <span class="n">gem</span> <span class="s1">&#39;uglifier&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;= 1.0.3&#39;</span>
<span class="lineno"> 8 </span><span class="k">end</span>
<span class="lineno"> 9 </span><span class="n">gem</span> <span class="s1">&#39;jquery-rails&#39;</span>
<span class="lineno">10 </span><span class="n">gem</span> <span class="s1">&#39;capistrano&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
<span class="lineno">11 </span><span class="n">gem</span> <span class="s1">&#39;unicorn&#39;</span>
</code></pre></div>


<p>and re-bundle:
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span> bundle 
</code></pre></div>
</p>

<p>Now lets start prepping for deployment and compile our assets.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span>capify .
<span class="lineno">2 </span>rake assets:precompile <span class="c"># dont forget to add it to git!</span>
</code></pre></div>


<p>Make a file called config/unicorn.rb:
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno"> 1 </span><span class="c1"># config/unicorn.rb</span>
<span class="lineno"> 2 </span><span class="c1"># Set environment to development unless something else is specified</span>
<span class="lineno"> 3 </span><span class="n">env</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;RAILS_ENV&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="s2">&quot;development&quot;</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span><span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;tester&#39;</span>
<span class="lineno"> 6 </span><span class="n">deploy_user</span> <span class="o">=</span> <span class="s1">&#39;ubuntu&#39;</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span><span class="c1"># See http://unicorn.bogomips.org/Unicorn/Configurator.html for complete</span>
<span class="lineno"> 9 </span><span class="c1"># documentation.</span>
<span class="lineno">10 </span><span class="n">worker_processes</span> <span class="mi">4</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span><span class="c1"># listen on both a Unix domain socket and a TCP port,</span>
<span class="lineno">13 </span><span class="c1"># we use a shorter backlog for quicker failover when busy</span>
<span class="lineno">14 </span><span class="n">listen</span> <span class="s2">&quot;/tmp/</span><span class="si">#{</span><span class="n">site</span><span class="si">}</span><span class="s2">.socket&quot;</span><span class="p">,</span> <span class="ss">:backlog</span> <span class="o">=&gt;</span> <span class="mi">64</span>
<span class="lineno">15 </span>
<span class="lineno">16 </span><span class="c1"># Preload our app for more speed</span>
<span class="lineno">17 </span><span class="n">preload_app</span> <span class="kp">true</span>
<span class="lineno">18 </span>
<span class="lineno">19 </span><span class="c1"># nuke workers after 30 seconds instead of 60 seconds (the default)</span>
<span class="lineno">20 </span><span class="n">timeout</span> <span class="mi">30</span>
<span class="lineno">21 </span>
<span class="lineno">22 </span><span class="n">pid</span> <span class="s2">&quot;/tmp/unicorn.</span><span class="si">#{</span><span class="n">site</span><span class="si">}</span><span class="s2">.pid&quot;</span>
<span class="lineno">23 </span>
<span class="lineno">24 </span><span class="c1"># Production specific settings</span>
<span class="lineno">25 </span><span class="k">if</span> <span class="n">env</span> <span class="o">==</span> <span class="s2">&quot;production&quot;</span>
<span class="lineno">26 </span>  <span class="c1"># Help ensure your application will always spawn in the symlinked</span>
<span class="lineno">27 </span>  <span class="c1"># &quot;current&quot; directory that Capistrano sets up.</span>
<span class="lineno">28 </span>  <span class="n">working_directory</span> <span class="s2">&quot;/home/</span><span class="si">#{</span><span class="n">deploy_user</span><span class="si">}</span><span class="s2">/apps/</span><span class="si">#{</span><span class="n">site</span><span class="si">}</span><span class="s2">/current&quot;</span>
<span class="lineno">29 </span>
<span class="lineno">30 </span>  <span class="c1"># feel free to point this anywhere accessible on the filesystem</span>
<span class="lineno">31 </span>  <span class="n">shared_path</span> <span class="o">=</span> <span class="s2">&quot;/home/</span><span class="si">#{</span><span class="n">deploy_user</span><span class="si">}</span><span class="s2">/apps/</span><span class="si">#{</span><span class="n">site</span><span class="si">}</span><span class="s2">/shared&quot;</span>
<span class="lineno">32 </span>
<span class="lineno">33 </span>  <span class="n">stderr_path</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/log/unicorn.stderr.log&quot;</span>
<span class="lineno">34 </span>  <span class="n">stdout_path</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/log/unicorn.stdout.log&quot;</span>
<span class="lineno">35 </span><span class="k">end</span>
<span class="lineno">36 </span>
<span class="lineno">37 </span><span class="n">before_fork</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="p">,</span> <span class="n">worker</span><span class="o">|</span>
<span class="lineno">38 </span>  <span class="c1"># the following is highly recomended for Rails + &quot;preload_app true&quot;</span>
<span class="lineno">39 </span>  <span class="c1"># as there&#39;s no need for the master process to hold a connection</span>
<span class="lineno">40 </span>  <span class="k">if</span> <span class="n">defined?</span><span class="p">(</span><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">)</span>
<span class="lineno">41 </span>    <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">disconnect!</span>
<span class="lineno">42 </span>  <span class="k">end</span>
<span class="lineno">43 </span>
<span class="lineno">44 </span>  <span class="c1"># Before forking, kill the master process that belongs to the .oldbin PID.</span>
<span class="lineno">45 </span>  <span class="c1"># This enables 0 downtime deploys.</span>
<span class="lineno">46 </span>  <span class="n">old_pid</span> <span class="o">=</span> <span class="s2">&quot;/tmp/unicorn.</span><span class="si">#{</span><span class="n">site</span><span class="si">}</span><span class="s2">.pid.oldbin&quot;</span>
<span class="lineno">47 </span>  <span class="k">if</span> <span class="no">File</span><span class="o">.</span><span class="n">exists?</span><span class="p">(</span><span class="n">old_pid</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">server</span><span class="o">.</span><span class="n">pid</span> <span class="o">!=</span> <span class="n">old_pid</span>
<span class="lineno">48 </span>    <span class="k">begin</span>
<span class="lineno">49 </span>      <span class="no">Process</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="s2">&quot;QUIT&quot;</span><span class="p">,</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">old_pid</span><span class="p">)</span><span class="o">.</span><span class="n">to_i</span><span class="p">)</span>
<span class="lineno">50 </span>    <span class="k">rescue</span> <span class="no">Errno</span><span class="o">::</span><span class="no">ENOENT</span><span class="p">,</span> <span class="no">Errno</span><span class="o">::</span><span class="no">ESRCH</span>
<span class="lineno">51 </span>      <span class="c1"># someone else did our job for us</span>
<span class="lineno">52 </span>    <span class="k">end</span>
<span class="lineno">53 </span>  <span class="k">end</span>
<span class="lineno">54 </span><span class="k">end</span>
<span class="lineno">55 </span>
<span class="lineno">56 </span><span class="n">after_fork</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="p">,</span> <span class="n">worker</span><span class="o">|</span>
<span class="lineno">57 </span>  <span class="c1"># the following is *required* for Rails + &quot;preload_app true&quot;,</span>
<span class="lineno">58 </span>  <span class="k">if</span> <span class="n">defined?</span><span class="p">(</span><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">)</span>
<span class="lineno">59 </span>    <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">establish_connection</span>
<span class="lineno">60 </span>  <span class="k">end</span>
<span class="lineno">61 </span>
<span class="lineno">62 </span>  <span class="c1"># if preload_app is true, then you may also want to check and</span>
<span class="lineno">63 </span>  <span class="c1"># restart any other shared sockets/descriptors such as Memcached,</span>
<span class="lineno">64 </span>  <span class="c1"># and Redis.  TokyoCabinet file handles are safe to reuse</span>
<span class="lineno">65 </span>  <span class="c1"># between any number of forked children (assuming your kernel</span>
<span class="lineno">66 </span>  <span class="c1"># correctly implements pread()/pwrite() system calls)</span>
<span class="lineno">67 </span><span class="k">end</span>
</code></pre></div>

_</p>

<p>Now lets setup the config/deploy.rb to be more unicorn and git friendly, take note of the default environment settings which are taken from the server when running rvm info <a href="http://ariejan.net/2011/09/14/lighting-fast-zero-downtime-deployments-with-git-capistrano-nginx-and-unicorn/">modified version of ariejan.net&rsquo;s</a>:</p>

<p><div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno">  1 </span><span class="nb">require</span> <span class="s2">&quot;bundler/capistrano&quot;</span>
<span class="lineno">  2 </span>
<span class="lineno">  3 </span><span class="n">set</span> <span class="ss">:scm</span><span class="p">,</span>             <span class="ss">:git</span>
<span class="lineno">  4 </span><span class="n">set</span> <span class="ss">:repository</span><span class="p">,</span>      <span class="s2">&quot;git@github.com:bluescripts/tester.git&quot;</span>
<span class="lineno">  5 </span><span class="n">set</span> <span class="ss">:branch</span><span class="p">,</span>          <span class="s2">&quot;origin/master&quot;</span>
<span class="lineno">  6 </span><span class="n">set</span> <span class="ss">:migrate_target</span><span class="p">,</span>  <span class="ss">:current</span>
<span class="lineno">  7 </span><span class="n">set</span> <span class="ss">:ssh_options</span><span class="p">,</span>     <span class="p">{</span> <span class="ss">:forward_agent</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span>
<span class="lineno">  8 </span><span class="n">set</span> <span class="ss">:rails_env</span><span class="p">,</span>       <span class="s2">&quot;production&quot;</span>
<span class="lineno">  9 </span><span class="n">set</span> <span class="ss">:deploy_to</span><span class="p">,</span>       <span class="s2">&quot;/home/ubuntu/apps/tester&quot;</span>
<span class="lineno"> 10 </span><span class="n">set</span> <span class="ss">:normalize_asset_timestamps</span><span class="p">,</span> <span class="kp">false</span>
<span class="lineno"> 11 </span>
<span class="lineno"> 12 </span><span class="n">set</span> <span class="ss">:user</span><span class="p">,</span>            <span class="s2">&quot;ubuntu&quot;</span>
<span class="lineno"> 13 </span><span class="n">set</span> <span class="ss">:group</span><span class="p">,</span>           <span class="s2">&quot;ubuntu&quot;</span>
<span class="lineno"> 14 </span><span class="n">set</span> <span class="ss">:use_sudo</span><span class="p">,</span>        <span class="kp">false</span>
<span class="lineno"> 15 </span>
<span class="lineno"> 16 </span><span class="n">role</span> <span class="ss">:web</span><span class="p">,</span>    <span class="s2">&quot;192.168.5.113&quot;</span>
<span class="lineno"> 17 </span><span class="n">role</span> <span class="ss">:db</span><span class="p">,</span>     <span class="s2">&quot;192.168.5.113&quot;</span><span class="p">,</span> <span class="ss">:primary</span> <span class="o">=&gt;</span> <span class="kp">true</span>
<span class="lineno"> 18 </span>
<span class="lineno"> 19 </span><span class="n">set</span><span class="p">(</span><span class="ss">:latest_release</span><span class="p">)</span>  <span class="p">{</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:current_path</span><span class="p">)</span> <span class="p">}</span>
<span class="lineno"> 20 </span><span class="n">set</span><span class="p">(</span><span class="ss">:release_path</span><span class="p">)</span>    <span class="p">{</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:current_path</span><span class="p">)</span> <span class="p">}</span>
<span class="lineno"> 21 </span><span class="n">set</span><span class="p">(</span><span class="ss">:current_release</span><span class="p">)</span> <span class="p">{</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:current_path</span><span class="p">)</span> <span class="p">}</span>
<span class="lineno"> 22 </span>
<span class="lineno"> 23 </span><span class="n">set</span><span class="p">(</span><span class="ss">:current_revision</span><span class="p">)</span>  <span class="p">{</span> <span class="n">capture</span><span class="p">(</span><span class="s2">&quot;cd </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">; git rev-parse --short HEAD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span> <span class="p">}</span>
<span class="lineno"> 24 </span><span class="n">set</span><span class="p">(</span><span class="ss">:latest_revision</span><span class="p">)</span>   <span class="p">{</span> <span class="n">capture</span><span class="p">(</span><span class="s2">&quot;cd </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">; git rev-parse --short HEAD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span> <span class="p">}</span>
<span class="lineno"> 25 </span><span class="n">set</span><span class="p">(</span><span class="ss">:previous_revision</span><span class="p">)</span> <span class="p">{</span> <span class="n">capture</span><span class="p">(</span><span class="s2">&quot;cd </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">; git rev-parse --short HEAD@{1}&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span> <span class="p">}</span>
<span class="lineno"> 26 </span>
<span class="lineno"> 27 </span><span class="n">default_environment</span><span class="o">[</span><span class="s2">&quot;RAILS_ENV&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;production&#39;</span>
<span class="lineno"> 28 </span>
<span class="lineno"> 29 </span><span class="n">default_environment</span><span class="o">[</span><span class="s2">&quot;PATH&quot;</span><span class="o">]</span>         <span class="o">=</span> <span class="s2">&quot;/home/ubuntu/.rvm/gems/ruby-1.9.3-p194/bin:/home/ubuntu/.rvm/gems/ruby-1.9.3-p194@global/bin:/home/ubuntu/.rvm/rubies/ruby-1.9.3-p194/bin:/home/ubuntu/.rvm/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games&quot;</span>
<span class="lineno"> 30 </span><span class="n">default_environment</span><span class="o">[</span><span class="s2">&quot;GEM_HOME&quot;</span><span class="o">]</span>     <span class="o">=</span> <span class="s2">&quot;/home/ubuntu/.rvm/gems/ruby-1.9.3-p194&quot;</span>
<span class="lineno"> 31 </span><span class="n">default_environment</span><span class="o">[</span><span class="s2">&quot;GEM_PATH&quot;</span><span class="o">]</span>     <span class="o">=</span> <span class="s2">&quot;/home/ubuntu/.rvm/gems/ruby-1.9.3-p194:/home/ubuntu/.rvm/gems/ruby-1.9.3-p194@global&quot;</span>
<span class="lineno"> 32 </span><span class="n">default_environment</span><span class="o">[</span><span class="s2">&quot;RUBY_VERSION&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;ruby-1.9.3-p194&quot;</span>
<span class="lineno"> 33 </span>
<span class="lineno"> 34 </span><span class="n">default_run_options</span><span class="o">[</span><span class="ss">:shell</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;bash&#39;</span>
<span class="lineno"> 35 </span>
<span class="lineno"> 36 </span><span class="n">namespace</span> <span class="ss">:deploy</span> <span class="k">do</span>
<span class="lineno"> 37 </span>  <span class="n">desc</span> <span class="s2">&quot;Deploy your application&quot;</span>
<span class="lineno"> 38 </span>  <span class="n">task</span> <span class="ss">:default</span> <span class="k">do</span>
<span class="lineno"> 39 </span>    <span class="n">update</span>
<span class="lineno"> 40 </span>    <span class="n">restart</span>
<span class="lineno"> 41 </span>  <span class="k">end</span>
<span class="lineno"> 42 </span>
<span class="lineno"> 43 </span>  <span class="n">desc</span> <span class="s2">&quot;Setup your git-based deployment app&quot;</span>
<span class="lineno"> 44 </span>  <span class="n">task</span> <span class="ss">:setup</span><span class="p">,</span> <span class="ss">:except</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:no_release</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span> <span class="k">do</span>
<span class="lineno"> 45 </span>    <span class="n">dirs</span> <span class="o">=</span> <span class="o">[</span><span class="n">deploy_to</span><span class="p">,</span> <span class="n">shared_path</span><span class="o">]</span>
<span class="lineno"> 46 </span>    <span class="n">dirs</span> <span class="o">+=</span> <span class="n">shared_children</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">d</span><span class="o">|</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">shared_path</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="p">}</span>
<span class="lineno"> 47 </span>    <span class="n">run</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">try_sudo</span><span class="si">}</span><span class="s2"> mkdir -p </span><span class="si">#{</span><span class="n">dirs</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">#{</span><span class="n">try_sudo</span><span class="si">}</span><span class="s2"> chmod g+w </span><span class="si">#{</span><span class="n">dirs</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="lineno"> 48 </span>    <span class="n">run</span> <span class="s2">&quot;git clone </span><span class="si">#{</span><span class="n">repository</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="lineno"> 49 </span>  <span class="k">end</span>
<span class="lineno"> 50 </span>
<span class="lineno"> 51 </span>  <span class="n">task</span> <span class="ss">:cold</span> <span class="k">do</span>
<span class="lineno"> 52 </span>    <span class="n">update</span>
<span class="lineno"> 53 </span>    <span class="n">migrate</span>
<span class="lineno"> 54 </span>  <span class="k">end</span>
<span class="lineno"> 55 </span>
<span class="lineno"> 56 </span>  <span class="n">task</span> <span class="ss">:update</span> <span class="k">do</span>
<span class="lineno"> 57 </span>    <span class="n">transaction</span> <span class="k">do</span>
<span class="lineno"> 58 </span>      <span class="n">update_code</span>
<span class="lineno"> 59 </span>    <span class="k">end</span>
<span class="lineno"> 60 </span>  <span class="k">end</span>
<span class="lineno"> 61 </span>
<span class="lineno"> 62 </span>  <span class="n">desc</span> <span class="s2">&quot;Update the deployed code.&quot;</span>
<span class="lineno"> 63 </span>  <span class="n">task</span> <span class="ss">:update_code</span><span class="p">,</span> <span class="ss">:except</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:no_release</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span> <span class="k">do</span>
<span class="lineno"> 64 </span>    <span class="n">run</span> <span class="s2">&quot;cd </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">; git fetch origin; git reset --hard </span><span class="si">#{</span><span class="n">branch</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="lineno"> 65 </span>    <span class="n">finalize_update</span>
<span class="lineno"> 66 </span>  <span class="k">end</span>
<span class="lineno"> 67 </span>
<span class="lineno"> 68 </span>  <span class="n">desc</span> <span class="s2">&quot;Update the database (overwritten to avoid symlink)&quot;</span>
<span class="lineno"> 69 </span>  <span class="n">task</span> <span class="ss">:migrations</span> <span class="k">do</span>
<span class="lineno"> 70 </span>    <span class="n">transaction</span> <span class="k">do</span>
<span class="lineno"> 71 </span>      <span class="n">update_code</span>
<span class="lineno"> 72 </span>    <span class="k">end</span>
<span class="lineno"> 73 </span>    <span class="n">migrate</span>
<span class="lineno"> 74 </span>    <span class="n">restart</span>
<span class="lineno"> 75 </span>  <span class="k">end</span>
<span class="lineno"> 76 </span>
<span class="lineno"> 77 </span>  <span class="n">task</span> <span class="ss">:finalize_update</span><span class="p">,</span> <span class="ss">:except</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:no_release</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span> <span class="k">do</span>
<span class="lineno"> 78 </span>    <span class="n">run</span> <span class="s2">&quot;chmod -R g+w </span><span class="si">#{</span><span class="n">latest_release</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:group_writable</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span>
<span class="lineno"> 79 </span>
<span class="lineno"> 80 </span>    <span class="c1"># mkdir -p is making sure that the directories are there for some SCM&#39;s that don&#39;t</span>
<span class="lineno"> 81 </span>    <span class="c1"># save empty folders</span>
<span class="lineno"> 82 </span>    <span class="n">run</span> <span class="o">&lt;&lt;-</span><span class="no">CMD</span>
<span class="lineno"> 83 </span><span class="sh">      rm -rf #{latest_release}/log #{latest_release}/public/system #{latest_release}/tmp/pids &amp;&amp;</span>
<span class="lineno"> 84 </span><span class="sh">      mkdir -p #{latest_release}/public &amp;&amp;</span>
<span class="lineno"> 85 </span><span class="sh">      mkdir -p #{latest_release}/tmp &amp;&amp;</span>
<span class="lineno"> 86 </span><span class="sh">      ln -s #{shared_path}/log #{latest_release}/log &amp;&amp;</span>
<span class="lineno"> 87 </span><span class="sh">      ln -s #{shared_path}/system #{latest_release}/public/system &amp;&amp;</span>
<span class="lineno"> 88 </span><span class="sh">      ln -s #{shared_path}/pids #{latest_release}/tmp/pids &amp;&amp;</span>
<span class="lineno"> 89 </span><span class="sh">      ln -sf #{shared_path}/database.yml #{latest_release}/config/database.yml</span>
<span class="lineno"> 90 </span><span class="no">    CMD</span>
<span class="lineno"> 91 </span>
<span class="lineno"> 92 </span>    <span class="k">if</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:normalize_asset_timestamps</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span>
<span class="lineno"> 93 </span>      <span class="n">stamp</span> <span class="o">=</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">utc</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m%d%H%M.%S&quot;</span><span class="p">)</span>
<span class="lineno"> 94 </span>      <span class="n">asset_paths</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:public_children</span><span class="p">,</span> <span class="sx">%w(images stylesheets javascripts)</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">latest_release</span><span class="si">}</span><span class="s2">/public/</span><span class="si">#{</span><span class="nb">p</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="lineno"> 95 </span>      <span class="n">run</span> <span class="s2">&quot;find </span><span class="si">#{</span><span class="n">asset_paths</span><span class="si">}</span><span class="s2"> -exec touch -t </span><span class="si">#{</span><span class="n">stamp</span><span class="si">}</span><span class="s2"> {} &#39;;&#39;; true&quot;</span><span class="p">,</span> <span class="ss">:env</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s2">&quot;TZ&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;UTC&quot;</span> <span class="p">}</span>
<span class="lineno"> 96 </span>    <span class="k">end</span>
<span class="lineno"> 97 </span>  <span class="k">end</span>
<span class="lineno"> 98 </span>
<span class="lineno"> 99 </span>  <span class="n">desc</span> <span class="s2">&quot;Zero-downtime restart of Unicorn&quot;</span>
<span class="lineno">100 </span>  <span class="n">task</span> <span class="ss">:restart</span><span class="p">,</span> <span class="ss">:except</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:no_release</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span> <span class="k">do</span>
<span class="lineno">101 </span>    <span class="n">run</span> <span class="s2">&quot;kill -s USR2 `cat /tmp/unicorn.tester.pid`&quot;</span>
<span class="lineno">102 </span>  <span class="k">end</span>
<span class="lineno">103 </span>
<span class="lineno">104 </span>  <span class="n">desc</span> <span class="s2">&quot;Start unicorn&quot;</span>
<span class="lineno">105 </span>  <span class="n">task</span> <span class="ss">:start</span><span class="p">,</span> <span class="ss">:except</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:no_release</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span> <span class="k">do</span>
<span class="lineno">106 </span>    <span class="n">run</span> <span class="s2">&quot;cd </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2"> ; bundle exec unicorn_rails -c config/unicorn.rb -D&quot;</span>
<span class="lineno">107 </span>  <span class="k">end</span>
<span class="lineno">108 </span>
<span class="lineno">109 </span>  <span class="n">desc</span> <span class="s2">&quot;Stop unicorn&quot;</span>
<span class="lineno">110 </span>  <span class="n">task</span> <span class="ss">:stop</span><span class="p">,</span> <span class="ss">:except</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:no_release</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span> <span class="k">do</span>
<span class="lineno">111 </span>    <span class="n">run</span> <span class="s2">&quot;kill -s QUIT `cat /tmp/unicorn.tester.pid`&quot;</span>
<span class="lineno">112 </span>  <span class="k">end</span>
<span class="lineno">113 </span>
<span class="lineno">114 </span>  <span class="n">namespace</span> <span class="ss">:rollback</span> <span class="k">do</span>
<span class="lineno">115 </span>    <span class="n">desc</span> <span class="s2">&quot;Moves the repo back to the previous version of HEAD&quot;</span>
<span class="lineno">116 </span>    <span class="n">task</span> <span class="ss">:repo</span><span class="p">,</span> <span class="ss">:except</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:no_release</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span> <span class="k">do</span>
<span class="lineno">117 </span>      <span class="n">set</span> <span class="ss">:branch</span><span class="p">,</span> <span class="s2">&quot;HEAD@{1}&quot;</span>
<span class="lineno">118 </span>      <span class="n">deploy</span><span class="o">.</span><span class="n">default</span>
<span class="lineno">119 </span>    <span class="k">end</span>
<span class="lineno">120 </span>
<span class="lineno">121 </span>    <span class="n">desc</span> <span class="s2">&quot;Rewrite reflog so HEAD@{1} will continue to point to at the next previous release.&quot;</span>
<span class="lineno">122 </span>    <span class="n">task</span> <span class="ss">:cleanup</span><span class="p">,</span> <span class="ss">:except</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:no_release</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span> <span class="k">do</span>
<span class="lineno">123 </span>      <span class="n">run</span> <span class="s2">&quot;cd </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">; git reflog delete --rewrite HEAD@{1}; git reflog delete --rewrite HEAD@{1}&quot;</span>
<span class="lineno">124 </span>    <span class="k">end</span>
<span class="lineno">125 </span>
<span class="lineno">126 </span>    <span class="n">desc</span> <span class="s2">&quot;Rolls back to the previously deployed version.&quot;</span>
<span class="lineno">127 </span>    <span class="n">task</span> <span class="ss">:default</span> <span class="k">do</span>
<span class="lineno">128 </span>      <span class="n">rollback</span><span class="o">.</span><span class="n">repo</span>
<span class="lineno">129 </span>      <span class="n">rollback</span><span class="o">.</span><span class="n">cleanup</span>
<span class="lineno">130 </span>    <span class="k">end</span>
<span class="lineno">131 </span>  <span class="k">end</span>
<span class="lineno">132 </span><span class="k">end</span>
<span class="lineno">133 </span>
<span class="lineno">134 </span><span class="k">def</span> <span class="nf">run_rake</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
<span class="lineno">135 </span>  <span class="n">run</span> <span class="s2">&quot;cd </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">; </span><span class="si">#{</span><span class="n">rake</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">cmd</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="lineno">136 </span><span class="k">end</span>
</code></pre></div>
</p>

<p>Now lets try deploying (you may need to login to the server if this is the first time you&rsquo;ve cloned from git to accept the SSH handshake):
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span>cap deploy:setup
</code></pre></div>
</p>

<p>Create your database config file in shared/database.yml:
<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="lineno">1 </span><span class="l-Scalar-Plain">production</span><span class="p-Indicator">:</span>
<span class="lineno">2 </span>  <span class="l-Scalar-Plain">adapter</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mysql2</span>
<span class="lineno">3 </span>  <span class="l-Scalar-Plain">encoding</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">utf8</span>
<span class="lineno">4 </span>  <span class="l-Scalar-Plain">reconnect</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>
<span class="lineno">5 </span>  <span class="l-Scalar-Plain">database</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tester_production</span>
<span class="lineno">6 </span>  <span class="l-Scalar-Plain">pool</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">5</span>
<span class="lineno">7 </span>  <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">root</span>
<span class="lineno">8 </span>  <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span>
</code></pre></div>

_</p>

<p>Go into current and create the database if you haven&rsquo;t already:
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span>rake db:create
<span class="lineno">2 </span><span class="c"># cd down a level</span>
<span class="lineno">3 </span><span class="nb">cd</span> ../
<span class="lineno">4 </span>mkdir -p shared/pids
</code></pre></div>
</p>

<p>Now we can run the cold deploy:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno">1 </span>cap deploy:cold
<span class="lineno">2 </span>cap deploy:start
</code></pre></div>


<p>Now we can configure nginx:</p>

<p>Open up /etc/nginx/sites-enabled/default:
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="lineno"> 1 </span>upstream tester <span class="o">{</span>
<span class="lineno"> 2 </span>	server unix:/tmp/tester.socket <span class="nv">fail_timeout</span><span class="o">=</span>0<span class="p">;</span>
<span class="lineno"> 3 </span><span class="o">}</span>
<span class="lineno"> 4 </span>server <span class="o">{</span>
<span class="lineno"> 5 </span>	listen <span class="m">80</span> default<span class="p">;</span>
<span class="lineno"> 6 </span> 	root /home/ubuntu/apps/tester/current/public<span class="p">;</span>
<span class="lineno"> 7 </span>	location / <span class="o">{</span>
<span class="lineno"> 8 </span>		proxy_pass  http://tester<span class="p">;</span>
<span class="lineno"> 9 </span>		proxy_redirect     off<span class="p">;</span>
<span class="lineno">10 </span>
<span class="lineno">11 </span>		proxy_set_header   Host             <span class="nv">$host</span><span class="p">;</span>
<span class="lineno">12 </span>		proxy_set_header   X-Real-IP        <span class="nv">$remote_addr</span><span class="p">;</span>
<span class="lineno">13 </span>		proxy_set_header   X-Forwarded-For  <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<span class="lineno">14 </span>
<span class="lineno">15 </span>		client_max_body_size       10m<span class="p">;</span>
<span class="lineno">16 </span>		client_body_buffer_size    128k<span class="p">;</span>
<span class="lineno">17 </span>
<span class="lineno">18 </span>		proxy_connect_timeout      90<span class="p">;</span>
<span class="lineno">19 </span>		proxy_send_timeout         90<span class="p">;</span>
<span class="lineno">20 </span>		proxy_read_timeout         90<span class="p">;</span>
<span class="lineno">21 </span>
<span class="lineno">22 </span>		proxy_buffer_size          4k<span class="p">;</span>
<span class="lineno">23 </span>		proxy_buffers              <span class="m">4</span> 32k<span class="p">;</span>
<span class="lineno">24 </span>		proxy_busy_buffers_size    64k<span class="p">;</span>
<span class="lineno">25 </span>		proxy_temp_file_write_size 64k<span class="p">;</span>
<span class="lineno">26 </span>	<span class="o">}</span>
<span class="lineno">27 </span>
<span class="lineno">28 </span>	location ~ ^/<span class="o">(</span>images<span class="p">|</span>javascripts<span class="p">|</span>stylesheets<span class="p">|</span>system<span class="p">|</span>assets<span class="o">)</span>/  <span class="o">{</span>
<span class="lineno">29 </span>		root /home/deployer/apps/my_site/current/public<span class="p">;</span>
<span class="lineno">30 </span>		expires max<span class="p">;</span>
<span class="lineno">31 </span>		<span class="nb">break</span><span class="p">;</span>
<span class="lineno">32 </span>    <span class="o">}</span>
<span class="lineno">33 </span><span class="o">}</span>
</code></pre></div>
</p>

<p>Now restart nginx and visit <a href="http://192.168.5.113/">http://192.168.5.113/</a> ( replace with your server hostname/IP ). You should be all set!</p>
 </div>
      <footer class="post-footer">

  <div class="post-footer-data">
    
<div class="tags">
    
</div>

  </div>

</footer>


  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'bluescripts';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>
  Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




    </article>
  </div>
  <div class="sidebar">
  <section>
    <h1>Projects & Software</h1>
    <ul>
      <li><a href="https://github.com/joshrendek/docker-conductor">Docker Conductor</a> is a docker orchestration tool.</li>
      <li><a href="http://sshpot.com/">sshpot.com</a> is a SSH honeypot service written in Go (both web service and client are open source).</li>
      <li><a href="http://ifcfg.net/">ifcfg.net</a> is a simple 'what is my IP' service with a few extra RESTful endpoints.</li>

      <li><a href="/projects/">View More</a>

      <li><a href="https://github.com/joshrendek?tab=repositories"><img src="/images/github.png" style='border: none;'> More on GitHub</a></li>
      <li><a href="https://rubygems.org/profiles/joshrendek">Gems @ RubyGems</a></li>
    </ul>
  </section>

  <section>
    <h1>Other Blogs</h1>
    <ul>
      <li><a href="http://tendermeatlove.com">Tender Meat Love</a> is my blog about cooking.</li>
      <li><a href="http://hydronerd.com">Hydro Nerd</a> is my blog about hydroponics and gardening.</li>
    </ul>
  </section>

  <section>
    <h1>Recent Posts</h1>
    <ul>
      
      <li><a href="https://joshrendek.com/2016/06/building-honeypots-and-analyzing-linux-malware/">Building honeypots and analyzing linux malware</a></li>
      
      <li><a href="https://joshrendek.com/2015/11/understanding-elasticsearch-performance/">Understanding ElasticSearch Performance</a></li>
      
      <li><a href="https://joshrendek.com/2015/11/building-a-distributed-waitgroup-with-go-and-redis/">Building a distributed WaitGroup with Go and Redis</a></li>
      
      <li><a href="https://joshrendek.com/2015/11/docker-and-ping-sendmsg-operation-not-permitted/">Docker and ping: sendmsg: Operation not permitted</a></li>
      
      <li><a href="https://joshrendek.com/2015/10/influx-alert/">Influx Alert</a></li>
      
    </ul>
  </section>

</div>

</main>
  <footer>

  <div class="social-links-footer">

  

  

  

  

  

  <div class="social-link">
  <a href="https://joshrendek.com/index.xml" target="_blank">RSS</a>
  </div>

</div>


  <div class="copyright"> © Copyright 2008-2017 Josh Rendek </div>

  </footer>

</body>
</html>

